# {{ ansible_managed }}

# Disable DNS (only do DHCP)
port=0

{% for network in dnsmasq_networks | default([]) %}

# Bind dnsmasq to the interface for this network
interface={{ network.interface_name }}

dhcp-range=interface:{{ network.interface_name }},{{ network.address }},static,{{ network.netmask }}

{% for host in network.dhcp_assignments %}
dhcp-host={{ host.mac }},{{ host.name }},{{ host.ip }},24h
{% endfor %}

dhcp-option=interface:{{ network.interface_name }},3,{{ network.gateway }}
dhcp-option=interface:{{ network.interface_name }},6,{{ network.dns_servers | join(',') }}
dhcp-option=interface:{{ network.interface_name }},15,{{ network.domain_name }}

{% endfor %}