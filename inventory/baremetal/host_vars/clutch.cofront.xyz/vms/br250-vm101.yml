---
apiVersion: foundry.cofront.xyz/v1alpha1
kind: VirtualMachine
metadata:
  name: br250-vm101
  labels:
    environment: development
    network: br250
  annotations:
    description: "Test VM on br250 network"

spec:
  # Resource allocation
  vcpus: 2
  memoryGiB: 4

  # Boot disk configuration
  bootDisk:
    sizeGB: 20
    image: fedora-43-ext4.qcow2

  # Network configuration
  networkInterfaces:
    - ip: 10.250.250.101/24
      gateway: 10.250.250.1
      dnsServers:
        - 8.8.8.8
        - 1.1.1.1
      bridge: br250
      defaultRoute: true

  # Cloud-init configuration
  cloudInit:
    fqdn: br250-vm101.cofront.xyz
    sshAuthorizedKeys:
      - "{{ vault_hypervisor_ssh_keys | default([]) | first | default('') }}"
    sshPasswordAuth: false
